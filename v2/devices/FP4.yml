name: "Fairphone 4"
codename: "FP4"
formfactor: "phone"
aliases: ["fp4"]
doppelgangers: []
user_actions:
  confirm_model:
    title: "Confirm your model"
    description: "Please check that your device is a Fairphone 4 (FP4)."
  confirm_os:
    title: "Confirm OS version"
    description: "Your device must be running the Fairphone OS version of Android 11 before installing Ubuntu Touch. With a previously installed /e/ OS, it won't work!"
    link: "https://support.fairphone.com/hc/en-us/articles/4405858261777?s=09"
  bootloader:
    title: "Reboot to Bootloader"
    description: "With the device powered off, press and hold the VOLUME DOWN and POWER buttons at the same time until the phone vibrates. After some seconds you'll see the fastboot mode. Or just reboot and press and hold VOLUME DOWN BUTTON while rebooting."
    image: "phone_power_down"
    button: true
  recovery:
    title: "Reboot to Recovery"
    description: 'With the device still at the "Fastboot Mode" (green), use the Volume buttons to switch to "Recovery Mode" (red) and push the power button to confirm your selection.'
    image: "phone_power_up"
    button: true
unlock:
  - "confirm_model"
  - "confirm_os"
handlers:
  bootloader_locked:
    actions:
      - fastboot:oem_unlock:
          code_url: "https://www.fairphone.com/en/bootloader-unlocking-code-for-fairphone-3"
operating_systems:
  - name: "Ubuntu Touch"
    compatible_installer: ">=0.9.2-beta"
    options:
      - var: "channel"
        name: "Channel"
        tooltip: "The release channel"
        link: "https://docs.ubports.com/en/latest/about/process/release-schedule.html"
        type: "select"
        remote_values:
          systemimage:channels:
      - var: "wipe"
        name: "Wipe Userdata"
        tooltip: "Wipe personal data. This is necessary, for first time installations."
        type: "checkbox"
      - var: "bootstrap"
        name: "Bootstrap"
        tooltip: "Flash system partitions using fastboot"
        type: "checkbox"
        value: true
    prerequisites: []
    steps:
      - actions:
          - core:download:
              group: "firmware"
              files:
                - url: "https://files.beidl.guru/fp4/boot.img"
                  checksum:
                    sum: "d6e4315d352220213fd437db7114ffb6d6538266640773f2ad8beb929cd51b39"
                    algorithm: "sha256"
                - url: "https://files.beidl.guru/fp4/dtbo.img"
                  checksum:
                    sum: "68ad83e20eb2b47592c2b7fe48161893770b1727c7b7ce7240504eaf8612d733"
                    algorithm: "sha256"
                - url: "https://files.beidl.guru/fp4/recovery.img"
                  checksum:
                    sum: "43a86d7aedb802ce1bbf7f6664bd95f56fb05f7996b401edcb4ee5c515fc68c0"
                    algorithm: "sha256"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - adb:reboot:
              to_state: "bootloader"
        fallback:
          - core:user_action:
              action: "bootloader"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - fastboot:flash:
              partitions:
                - partition: "boot"
                  file: "boot.img"
                  group: "firmware"
                  raw: true
                - partition: "dtbo"
                  file: "dtbo.img"
                  group: "firmware"
                  raw: true
                - partition: "recovery"
                  file: "recovery.img"
                  group: "firmware"
                  raw: true
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - fastboot:erase:
              partition: "userdata"
        condition:
          var: "wipe"
          value: true
      - actions:
          - fastboot:format:
              partition: "userdata"
              type: "ext4"
        condition:
          var: "wipe"
          value: true
      - actions:
          - core:user_action:
              action: "recovery"
        condition:
          var: "bootstrap"
          value: true
      - actions:
          - adb:reboot:
              to_state: "recovery"
        fallback:
          - core:user_action:
              action: "recovery"
        condition:
          var: "bootstrap"
          value: false
      - actions:
          - systemimage:install:
      - actions:
          - adb:reboot:
              to_state: "recovery"
        fallback:
          - core:user_action:
              action: "recovery"
    slideshow: []
